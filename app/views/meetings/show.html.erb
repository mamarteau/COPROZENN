<div class="container mt-5 justify-content-center">
  <div class="card border-0 rounded shadow-lg p-4" style="max-width: 700px; width: 100%;">
    <h2><%= @meeting.title %></h2>
    <p><%= @meeting.date %></p>
    <p><%= @meeting.link %></p>
    <p><%= @meeting.description %></p>

    <p><%= link_to "Ajouter un document", new_meeting_document_path(@meeting), class:"button-card"%></p>

    <p><%= link_to "Ajouter une decision", new_meeting_decision_path(@meeting), class:"button-card"%></p>
  </div>

    <% if @meeting.documents.any? %>
      <% @meeting.documents.each do |document| %>
      <div class = "card border-0 rounded shadow-lg p-4" style="max-width: 300px;">
        <%= cl_image_tag document.file.key, class:"d-block w-100" %>
      </div>
      <% end %>
    <% end %>
  <p><%= link_to "Tous les meetings", meeting_path, class:"button-card"%></p>

  <div class="d-flex flex-column gap-4" data-controller="vote">
  <div class="show-card py-3">
    <div class="show-card-header mb-3">
      <h4 class=""><strong>Décisions</strong></h4>
    </div>
    <div class="px-3">
      <% @decisions.each_with_index do |decision, index| %>
        <div class=" p-2 d-flex justify-content-between align-items-left flex-column <%= "separator" if index > 0 %>">
          <div class="lien">
            <%= link_to vote_decision_path(decision), class: "d-flex align-items-center mb-1" do %>
              <%= image_tag "gavel.png", width: 30, height: 30, class: "me-2" %>
              <p class="mb-0 me-2"><%= decision.description %></p>
            <% end %>

          </div>

          <% if decision.closed? %>
            <div data-vote-target="resultSection" class="">
              <% total_pour = decision.for %>
              <% total_contre = decision.against %>

              <% if total_pour > total_contre %>
                <p class="mb-0 decision-subtext">La majorité a voté <strong>"Pour"</strong> avec <%= total_pour %> votes.</p>
              <% elsif total_contre > total_pour %>
                <p class="mb-0 decision-subtext">La majorité a voté <strong>"Contre"</strong> avec <%= total_contre %> votes.</p>
              <% else %>
                <p class="mb-0 decision-subtext">Il y a une égalité avec <%= total_pour %> votes "Pour" et <%= total_contre %> votes "Contre".</p>
              <% end %>
            </div>
          <% end %>
        </div>
        <% end %>

      <div class="d-flex justify-content-end mt-3">
        <div class="show-btn">Ajouter</div>
      </div>
    </div>

  </div>
</div>

</div>
